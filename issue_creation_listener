import com.atlassian.jira.component.ComponentAccessor
import com.atlassian.jira.mail.Email
import com.atlassian.jira.mail.EmailSender

def emailSender = ComponentAccessor.getComponent(EmailSender)
def issue = event.issue

def targetProjectKey = "EARTH"
def targetReporterUsername = "ron.dayers"

// Check if the issue is in the target project and the reporter matches
if (issue.projectObject.key == targetProjectKey && issue.reporter.username == targetReporterUsername) {
    def subject = "New Ticket Created in the EARTH Project: ${issue.key}"
    def body = """
    A new ticket has been created in the EARTH project:

    Issue Key: ${issue.key}
    Summary: ${issue.summary}
    """

    // Create and send the email
    def email = new Email(issue.reporter.emailAddress)
    email.subject = subject
    email.body = body

    try {
        emailSender.send(email)
        log.info("Notification sent to: ${issue.reporter.emailAddress}")
    } catch (Exception e) {
        log.error("Failed to send email to: ${issue.reporter.emailAddress}", e)
    }
}
