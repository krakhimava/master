import com.atlassian.jira.component.ComponentAccessor
import java.text.SimpleDateFormat
import java.util.Calendar

def dueDateField = getFieldByName("Due Date")

// get the field value
def dueDateValue = dueDateField?.getFormValue()?.toString()?.trim()

if (!dueDateValue) {
    dueDateField.setError("Due Date is required. Please select a date.")
} else {
    def dateFormat = new SimpleDateFormat("yyyy-MM-dd")
    def selectedDate = dateFormat.parse(dueDateValue)
    def currentDate = new Date()

    // checking the day of the week
    def calendar = Calendar.getInstance()
    calendar.setTime(selectedDate)
    def dayOfWeek = calendar.get(Calendar.DAY_OF_WEEK)

    // check if the date is today or in the past
    if (selectedDate.before(currentDate) || selectedDate.equals(currentDate)) {
        dueDateField.setError("Invalid date! Please select a future date.")
    } else if (dayOfWeek == Calendar.SATURDAY || dayOfWeek == Calendar.SUNDAY) {
        dueDateField.setError("Weekends are not allowed! Please choose a weekday.")
    } else {
        dueDateField.clearError()
    }
}
